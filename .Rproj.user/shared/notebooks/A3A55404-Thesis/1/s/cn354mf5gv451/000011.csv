"0","#  Articulation Rate (Number of syllables/ speaking time)"
"0",""
"0","# df$ParticipantID <- gsub(""(.*)_L[12]_Task[12]\\.wav"", ""\\1"", df$SoundfileID)"
"0","# df$Language <- gsub("".*_(L[12])_Task[12]\\.wav"", ""\\1"", df$SoundfileID)"
"0","# df$Task <- gsub("".*_L[12]_(Task[12])\\.wav"", ""\\1"", df$SoundfileID)"
"0",""
"0","calculate_articulation_rate <- function(nuclei_data, phrases_data, language, task) {"
"0","  "
"0","  nuclei_filtered <- nuclei_data %>% filter(Language == language, Task == task)"
"0","  "
"0","  phrases_filtered <- phrases_data %>% filter(Language == language, Task == task)"
"0","  "
"0","  silent_pause_intervals <- phrases_filtered %>%"
"0","    filter(text == 1) %>%"
"0","    select(tmin, tmax) %>%"
"0","    arrange(tmin)"
"0","  "
"0","  speaking_time <- 0"
"0","  for (i in 1:(nrow(silent_pause_intervals) - 1)) {"
"0","    speaking_time <- speaking_time + (silent_pause_intervals$tmin[i + 1] - silent_pause_intervals$tmax[i])"
"0","  }"
"0","  "
"0","  total_time <- max(nuclei_filtered$tmax)"
"0","  number_of_syllables <- nrow(nuclei_filtered)"
"0","  "
"0","  time_intervals <- seq(0, total_time, by = TIME_INTERVAL)"
"0","  articulation_rates <- numeric(length(time_intervals))"
"0",""
"0","  for (i in 1:length(time_intervals)) {"
"0","    start_time <- time_intervals[i]"
"0","    end_time <- start_time + TIME_INTERVAL"
"0","    "
"0","    syllables_in_interval <- nuclei_filtered %>%"
"0","      filter(tmax >= start_time & tmax <= end_time)"
"0","    "
"0","    syllables_count <- nrow(syllables_in_interval)"
"0","    "
"0","    if (speaking_time > 0) {"
"0","      articulation_rates[i] <- syllables_count / TIME_INTERVAL"
"0","    } else {"
"0","      articulation_rates[i] <- 0"
"0","    }"
"0","  }"
"0","  "
"0","  result <- data.frame("
"0","    Language = language,"
"0","    Task = task,"
"0","    TimeInterval = time_intervals,"
"0","    ArticulationRate = articulation_rates"
"0","  )"
"0","  "
"0","  return(result)"
"0","}"
"0",""
"0","languages <- c(""L1"", ""L2"")"
"0","tasks <- c(""Task1"", ""Task2"")"
"0",""
"0","articulation_rate_data <- data.frame()"
"0",""
"0","for (language in languages) {"
"0","  for (task in tasks) {"
"0","    nuclei_df_participant <- nuclei_df %>% filter(ParticipantID == SELECTED_PARTICIPANT_ID)"
"0","    phrases_df_participant <- phrases_df %>% filter(ParticipantID == SELECTED_PARTICIPANT_ID)"
"0",""
"0","    result <- calculate_articulation_rate(nuclei_df_participant, phrases_df_participant, language, task)"
"0","    articulation_rate_data <- bind_rows(articulation_rate_data, result)"
"0","  }"
"0","}"
"0",""
"0","ggplot(articulation_rate_data, aes(x = TimeInterval, y = ArticulationRate, group = interaction(Language, Task), color = interaction(Language, Task))) +"
"0","  geom_line() +"
"0","  geom_point() +"
"0","  labs("
"0","    title = ""Articulation Rate Over Time"","
"0","    x = ""Time Interval (seconds)"","
"0","    y = ""Articulation Rate"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  facet_grid(Language ~ Task)"
"0",""
