disease_score_clean[disease_score_clean$Cultivar == NA,]
disease_score_clean
unique(disease_score_clean$Cultivar)
length(disease_score_clean)
tail(disease_score_clean)
unique(disease_score_clean$Pathogen)
length(unique(disease_score_clean$Pathogen))
length(unique(disease_score_clean$Cultivar))
disease_score_clean$Treatment <- disease_score_clean$Treatment..1.34.
disease_score_clean$Block <- disease_score_clean$Block.nr.
disease_score_clean$Plant_nr <- disease_score_clean$Plant.nr.
disease_score_clean$T3 <- disease_score_clean$T3.disease..0.1.
disease_score_clean$T4 <- disease_score_clean$T4.disease....leaves.
disease_score_clean$T5_per <- disease_score_clean$T5.disease....
disease_score_clean$T5 <- disease_score_clean$T5.affected..0.1.
disease_score_clean$T6_per <- disease_score_clean$T6.disease....
disease_score_clean$T6 <- disease_score_clean$T6.affected..0.1.
disease_score_clean$T7_per <- disease_score_clean$T7.disease....
disease_score_clean$T7 <- disease_score_clean$T7.affected..0.1.
disease_score_clean$T8_per <- disease_score_clean$T8.disease....
disease_score_clean$T8 <- disease_score_clean$T8.affected..0.1.
disease_score_clean$T8_con <- disease_score_clean$T8.mate.disease..0.3.
disease_score_clean$T9_per <- disease_score_clean$T9.disease....
disease_score_clean$T9 <- disease_score_clean$T9.affected..0.1.
disease_score_clean$T9_con <- disease_score_clean$T9.mate.disease..0.3.
disease_score_clean$T5_length <- disease_score_clean$T5.length..cm.
disease_score_clean$T5_RGR <- disease_score_clean$T5.Relative.Growth.Rate.RGR..cm.
disease_score_clean$T9_length <- disease_score_clean$T9.length..cm.
disease_score_clean$T9_RGR <- disease_score_clean$T9.RGR..cm.
disease_score_clean$sensitivity_f <- disease_score_clean$sensitivity
disease_score_clean$time_to_first <- apply(disease_score_clean[,c("T3", "T5", "T6", "T7", "T8","T9")], 1, function(x) {
affected_week <- which(x == 1)
if (length(affected_week) == 0) {
return(70)
} else {
return(affected_week[1])
}
})
new_dataframe <- data.frame()
new_dataframe <- disease_score_clean %>%
select(sensitivity_f, Treatment, Soiltype, Cultivar, Pathogen, Plant_nr, Block, T3, T4, T5, T5_per, T6, T6_per, T7, T7_per, T8, T8_per, T9, T9_per, time_to_first, T5_length, T9_length, T5_RGR, T9_RGR, T8_con, T9_con, )
new_dataframe$sensitivity_f <- factor(new_dataframe$sensitivity_f, ordered = TRUE,
levels = c("Very sensitive", "Sensitive", "Reasonably sensitive",
"intermediate with some damage", "Relatively tolerant", "tolerant",
"highly tolerant", "Resistant"))
new_dataframe$T3 <- ifelse(new_dataframe$T3 == 0, 1, 0)
new_dataframe$T5 <- ifelse(new_dataframe$T5 == 0, 1, 0)
new_dataframe$T6 <- ifelse(new_dataframe$T6 == 0, 1, 0)
new_dataframe$T7 <- ifelse(new_dataframe$T7 == 0, 1, 0)
new_dataframe$T8 <- ifelse(new_dataframe$T8 == 0, 1, 0)
new_dataframe$T9 <- ifelse(new_dataframe$T9 == 0, 1, 0)
new_dataframe$Pathogen <- factor(disease_score_clean$Pathogen)
new_dataframe$Soiltype <- factor(disease_score_clean$Soiltype)
new_dataframe$Cultivar <- factor(disease_score_clean$Cultivar)
new_dataframe$Treatment <- factor(disease_score_clean$Treatment)
new_dataframe$T8_con <- factor(new_dataframe$T8_con, levels = 0:3)
new_dataframe$T9_con <- factor(new_dataframe$T9_con, levels = 0:3)
new_dataframe$T5_length <- as.numeric(sub(",", ".", new_dataframe$T5_length, fixed = TRUE))
new_dataframe$T9_length <- as.numeric(sub(",", ".", new_dataframe$T9_length, fixed = TRUE))
new_dataframe$T5_RGR <- as.numeric(sub(",", ".", new_dataframe$T5_RGR, fixed = TRUE))
new_dataframe$T9_RGR <- as.numeric(sub(",", ".", new_dataframe$T9_RGR, fixed = TRUE))
experiment_setup <- read.csv("experiment_setup.csv", sep = ";")
disease_score <- read.csv("disease_score.csv", sep = ";")
get_cultivar_label <- function(x) {
experiment_setup[experiment_setup$Cultivar == x,][1,]$Sensitivity
}
disease_score$sensitivity <- unlist(lapply(disease_score$Cultivar, get_cultivar_label))
n <- dim(disease_score)[1]
disease_score <- disease_score[1:(n-3),]
disease_score_clean <- disease_score %>%
filter(!is.na(sensitivity) & sensitivity != "",
T5.affected..0.1. >= 0, T5.Relative.Growth.Rate.RGR..cm. >= 0,
T9.affected..0.1. >= 0, T9.RGR..cm. >= 0)  %>%
na.omit()
disease_score_clean <- subset(disease_score, Pathogen != "negative control")
disease_score_clean
disease_score_clean$Treatment <- disease_score_clean$Treatment..1.34.
disease_score_clean$Block <- disease_score_clean$Block.nr.
disease_score_clean$Plant_nr <- disease_score_clean$Plant.nr.
disease_score_clean$T3 <- disease_score_clean$T3.disease..0.1.
disease_score_clean$T4 <- disease_score_clean$T4.disease....leaves.
disease_score_clean$T5_per <- disease_score_clean$T5.disease....
disease_score_clean$T5 <- disease_score_clean$T5.affected..0.1.
disease_score_clean$T6_per <- disease_score_clean$T6.disease....
disease_score_clean$T6 <- disease_score_clean$T6.affected..0.1.
disease_score_clean$T7_per <- disease_score_clean$T7.disease....
disease_score_clean$T7 <- disease_score_clean$T7.affected..0.1.
disease_score_clean$T8_per <- disease_score_clean$T8.disease....
disease_score_clean$T8 <- disease_score_clean$T8.affected..0.1.
disease_score_clean$T8_con <- disease_score_clean$T8.mate.disease..0.3.
disease_score_clean$T9_per <- disease_score_clean$T9.disease....
disease_score_clean$T9 <- disease_score_clean$T9.affected..0.1.
disease_score_clean$T9_con <- disease_score_clean$T9.mate.disease..0.3.
disease_score_clean$T5_length <- disease_score_clean$T5.length..cm.
disease_score_clean$T5_RGR <- disease_score_clean$T5.Relative.Growth.Rate.RGR..cm.
disease_score_clean$T9_length <- disease_score_clean$T9.length..cm.
disease_score_clean$T9_RGR <- disease_score_clean$T9.RGR..cm.
disease_score_clean$sensitivity_f <- disease_score_clean$sensitivity
disease_score_clean$time_to_first <- apply(disease_score_clean[,c("T3", "T5", "T6", "T7", "T8","T9")], 1, function(x) {
affected_week <- which(x == 1)
if (length(affected_week) == 0) {
return(70)
} else {
return(affected_week[1])
}
})
new_dataframe <- data.frame()
new_dataframe <- disease_score_clean %>%
select(sensitivity_f, Treatment, Soiltype, Cultivar, Pathogen, Plant_nr, Block, T3, T4, T5, T5_per, T6, T6_per, T7, T7_per, T8, T8_per, T9, T9_per, time_to_first, T5_length, T9_length, T5_RGR, T9_RGR, T8_con, T9_con, )
new_dataframe$sensitivity_f <- factor(new_dataframe$sensitivity_f, ordered = TRUE,
levels = c("Very sensitive", "Sensitive", "Reasonably sensitive",
"intermediate with some damage", "Relatively tolerant", "tolerant",
"highly tolerant", "Resistant"))
new_dataframe$T3 <- ifelse(new_dataframe$T3 == 0, 1, 0)
new_dataframe$T5 <- ifelse(new_dataframe$T5 == 0, 1, 0)
new_dataframe$T6 <- ifelse(new_dataframe$T6 == 0, 1, 0)
new_dataframe$T7 <- ifelse(new_dataframe$T7 == 0, 1, 0)
new_dataframe$T8 <- ifelse(new_dataframe$T8 == 0, 1, 0)
new_dataframe$T9 <- ifelse(new_dataframe$T9 == 0, 1, 0)
new_dataframe$Pathogen <- factor(disease_score_clean$Pathogen)
new_dataframe$Soiltype <- factor(disease_score_clean$Soiltype)
new_dataframe$Cultivar <- factor(disease_score_clean$Cultivar)
new_dataframe$Treatment <- factor(disease_score_clean$Treatment)
new_dataframe$T8_con <- factor(new_dataframe$T8_con, levels = 0:3)
new_dataframe$T9_con <- factor(new_dataframe$T9_con, levels = 0:3)
new_dataframe$T5_length <- as.numeric(sub(",", ".", new_dataframe$T5_length, fixed = TRUE))
new_dataframe$T9_length <- as.numeric(sub(",", ".", new_dataframe$T9_length, fixed = TRUE))
new_dataframe$T5_RGR <- as.numeric(sub(",", ".", new_dataframe$T5_RGR, fixed = TRUE))
new_dataframe$T9_RGR <- as.numeric(sub(",", ".", new_dataframe$T9_RGR, fixed = TRUE))
summary(new_dataframe)
disease_score_clean <- disease_score %>%
na.omit() %>%
filter(!is.na(sensitivity) & sensitivity != "",
T5.affected..0.1. >= 0, T5.Relative.Growth.Rate.RGR..cm. >= 0,
T9.affected..0.1. >= 0, T9.RGR..cm. >= 0)
disease_score_clean <- subset(disease_score, Pathogen != "negative control")
disease_score_clean
disease_score_clean$Treatment <- disease_score_clean$Treatment..1.34.
disease_score_clean$Block <- disease_score_clean$Block.nr.
disease_score_clean$Plant_nr <- disease_score_clean$Plant.nr.
disease_score_clean$T3 <- disease_score_clean$T3.disease..0.1.
disease_score_clean$T4 <- disease_score_clean$T4.disease....leaves.
disease_score_clean$T5_per <- disease_score_clean$T5.disease....
disease_score_clean$T5 <- disease_score_clean$T5.affected..0.1.
disease_score_clean$T6_per <- disease_score_clean$T6.disease....
disease_score_clean$T6 <- disease_score_clean$T6.affected..0.1.
disease_score_clean$T7_per <- disease_score_clean$T7.disease....
disease_score_clean$T7 <- disease_score_clean$T7.affected..0.1.
disease_score_clean$T8_per <- disease_score_clean$T8.disease....
disease_score_clean$T8 <- disease_score_clean$T8.affected..0.1.
disease_score_clean$T8_con <- disease_score_clean$T8.mate.disease..0.3.
disease_score_clean$T9_per <- disease_score_clean$T9.disease....
disease_score_clean$T9 <- disease_score_clean$T9.affected..0.1.
disease_score_clean$T9_con <- disease_score_clean$T9.mate.disease..0.3.
disease_score_clean$T5_length <- disease_score_clean$T5.length..cm.
disease_score_clean$T5_RGR <- disease_score_clean$T5.Relative.Growth.Rate.RGR..cm.
disease_score_clean$T9_length <- disease_score_clean$T9.length..cm.
disease_score_clean$T9_RGR <- disease_score_clean$T9.RGR..cm.
disease_score_clean$sensitivity_f <- disease_score_clean$sensitivity
disease_score_clean$time_to_first <- apply(disease_score_clean[,c("T3", "T5", "T6", "T7", "T8","T9")], 1, function(x) {
affected_week <- which(x == 1)
if (length(affected_week) == 0) {
return(70)
} else {
return(affected_week[1])
}
})
new_dataframe <- data.frame()
new_dataframe <- disease_score_clean %>%
select(sensitivity_f, Treatment, Soiltype, Cultivar, Pathogen, Plant_nr, Block, T3, T4, T5, T5_per, T6, T6_per, T7, T7_per, T8, T8_per, T9, T9_per, time_to_first, T5_length, T9_length, T5_RGR, T9_RGR, T8_con, T9_con, )
new_dataframe$sensitivity_f <- factor(new_dataframe$sensitivity_f, ordered = TRUE,
levels = c("Very sensitive", "Sensitive", "Reasonably sensitive",
"intermediate with some damage", "Relatively tolerant", "tolerant",
"highly tolerant", "Resistant"))
new_dataframe$T3 <- ifelse(new_dataframe$T3 == 0, 1, 0)
new_dataframe$T5 <- ifelse(new_dataframe$T5 == 0, 1, 0)
new_dataframe$T6 <- ifelse(new_dataframe$T6 == 0, 1, 0)
new_dataframe$T7 <- ifelse(new_dataframe$T7 == 0, 1, 0)
new_dataframe$T8 <- ifelse(new_dataframe$T8 == 0, 1, 0)
new_dataframe$T9 <- ifelse(new_dataframe$T9 == 0, 1, 0)
new_dataframe$Pathogen <- factor(disease_score_clean$Pathogen)
new_dataframe$Soiltype <- factor(disease_score_clean$Soiltype)
new_dataframe$Cultivar <- factor(disease_score_clean$Cultivar)
new_dataframe$Treatment <- factor(disease_score_clean$Treatment)
new_dataframe$T8_con <- factor(new_dataframe$T8_con, levels = 0:3)
new_dataframe$T9_con <- factor(new_dataframe$T9_con, levels = 0:3)
new_dataframe$T5_length <- as.numeric(sub(",", ".", new_dataframe$T5_length, fixed = TRUE))
new_dataframe$T9_length <- as.numeric(sub(",", ".", new_dataframe$T9_length, fixed = TRUE))
new_dataframe$T5_RGR <- as.numeric(sub(",", ".", new_dataframe$T5_RGR, fixed = TRUE))
new_dataframe$T9_RGR <- as.numeric(sub(",", ".", new_dataframe$T9_RGR, fixed = TRUE))
summary(new_dataframe)
new_dataframe <- na.omit(new_dataframe)
summary(new_dataframe)
disease_score_clean <- disease_score %>%
filter(!is.na(sensitivity) & sensitivity != "",
T5.affected..0.1. >= 0, T5.Relative.Growth.Rate.RGR..cm. >= 0,
T9.affected..0.1. >= 0, T9.RGR..cm. >= 0)
disease_score_clean <- subset(disease_score, Pathogen != "negative control")
disease_score_clean <- na.omit(disease_score_clean)
disease_score_clean
disease_score_clean$Treatment <- disease_score_clean$Treatment..1.34.
disease_score_clean$Block <- disease_score_clean$Block.nr.
disease_score_clean$Plant_nr <- disease_score_clean$Plant.nr.
disease_score_clean$T3 <- disease_score_clean$T3.disease..0.1.
disease_score_clean$T4 <- disease_score_clean$T4.disease....leaves.
disease_score_clean$T5_per <- disease_score_clean$T5.disease....
disease_score_clean$T5 <- disease_score_clean$T5.affected..0.1.
disease_score_clean$T6_per <- disease_score_clean$T6.disease....
disease_score_clean$T6 <- disease_score_clean$T6.affected..0.1.
disease_score_clean$T7_per <- disease_score_clean$T7.disease....
disease_score_clean$T7 <- disease_score_clean$T7.affected..0.1.
disease_score_clean$T8_per <- disease_score_clean$T8.disease....
disease_score_clean$T8 <- disease_score_clean$T8.affected..0.1.
disease_score_clean$T8_con <- disease_score_clean$T8.mate.disease..0.3.
disease_score_clean$T9_per <- disease_score_clean$T9.disease....
disease_score_clean$T9 <- disease_score_clean$T9.affected..0.1.
disease_score_clean$T9_con <- disease_score_clean$T9.mate.disease..0.3.
disease_score_clean$T5_length <- disease_score_clean$T5.length..cm.
disease_score_clean$T5_RGR <- disease_score_clean$T5.Relative.Growth.Rate.RGR..cm.
disease_score_clean$T9_length <- disease_score_clean$T9.length..cm.
disease_score_clean$T9_RGR <- disease_score_clean$T9.RGR..cm.
disease_score_clean$sensitivity_f <- disease_score_clean$sensitivity
disease_score_clean$time_to_first <- apply(disease_score_clean[,c("T3", "T5", "T6", "T7", "T8","T9")], 1, function(x) {
affected_week <- which(x == 1)
if (length(affected_week) == 0) {
return(70)
} else {
return(affected_week[1])
}
})
new_dataframe <- data.frame()
new_dataframe <- disease_score_clean %>%
select(sensitivity_f, Treatment, Soiltype, Cultivar, Pathogen, Plant_nr, Block, T3, T4, T5, T5_per, T6, T6_per, T7, T7_per, T8, T8_per, T9, T9_per, time_to_first, T5_length, T9_length, T5_RGR, T9_RGR, T8_con, T9_con, )
new_dataframe$sensitivity_f <- factor(new_dataframe$sensitivity_f, ordered = TRUE,
levels = c("Very sensitive", "Sensitive", "Reasonably sensitive",
"intermediate with some damage", "Relatively tolerant", "tolerant",
"highly tolerant", "Resistant"))
new_dataframe$T3 <- ifelse(new_dataframe$T3 == 0, 1, 0)
new_dataframe$T5 <- ifelse(new_dataframe$T5 == 0, 1, 0)
new_dataframe$T6 <- ifelse(new_dataframe$T6 == 0, 1, 0)
new_dataframe$T7 <- ifelse(new_dataframe$T7 == 0, 1, 0)
new_dataframe$T8 <- ifelse(new_dataframe$T8 == 0, 1, 0)
new_dataframe$T9 <- ifelse(new_dataframe$T9 == 0, 1, 0)
new_dataframe$Pathogen <- factor(disease_score_clean$Pathogen)
new_dataframe$Soiltype <- factor(disease_score_clean$Soiltype)
new_dataframe$Cultivar <- factor(disease_score_clean$Cultivar)
new_dataframe$Treatment <- factor(disease_score_clean$Treatment)
new_dataframe$T8_con <- factor(new_dataframe$T8_con, levels = 0:3)
new_dataframe$T9_con <- factor(new_dataframe$T9_con, levels = 0:3)
new_dataframe$T5_length <- as.numeric(sub(",", ".", new_dataframe$T5_length, fixed = TRUE))
new_dataframe$T9_length <- as.numeric(sub(",", ".", new_dataframe$T9_length, fixed = TRUE))
new_dataframe$T5_RGR <- as.numeric(sub(",", ".", new_dataframe$T5_RGR, fixed = TRUE))
new_dataframe$T9_RGR <- as.numeric(sub(",", ".", new_dataframe$T9_RGR, fixed = TRUE))
summary(new_dataframe)
# Bar plot for Sensitivity_f
ggplot(new_dataframe) + aes(x = sensitivity_f) +
geom_bar(fill = "darkmagenta") + coord_flip() +
theme_minimal() +
labs(title = "Bar Plot of Sensitivity", x = "Sensitivity", y = "Count")
# Bar plot for Pathogen
ggplot(new_dataframe, aes(x = Pathogen)) +
geom_bar(fill = "coral") +
theme_minimal() +
labs(title = "Bar Plot of Pathogen", x = "Pathogen", y = "Count")
# Bar plot for Cultivar
ggplot(new_dataframe, aes(x = Cultivar)) +
geom_bar(fill = "blue", width = 0.5) + coord_flip() +
theme_minimal() +
labs(title = "Bar Plot of Cultivar", x = "Cultivar", y = "Count")
# Bar plot for Soil type
ggplot(new_dataframe, aes(x = Soiltype)) +
geom_bar(fill = "green", width = 0.5) +
theme_minimal() +
labs(title = "Bar Plot of Soil type", x = "Soil type", y = "Count")
average_affected_leaves <- aggregate(T4 ~ Cultivar, data = new_dataframe, mean)
average_affected_leaves_sorted <- average_affected_leaves %>%
arrange(desc(T4))
ggplot(average_affected_leaves_sorted, aes(x = reorder(Cultivar, T4), y = T4)) +
geom_bar(stat = "identity", fill = "blue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(x = "Cultivar", y = "Average Affected Leaves", title = "Average Number of Affected Leaves per Cultivar")
# Without regression
by_cultivar <- split(new_dataframe, new_dataframe$Cultivar )
analysis_by_cultivar <- function(cultivar) {
cultivar_data <- by_cultivar[[cultivar]]
combined_data <- list()
for (block in unique(kennedy$Block)) {
block_data <- cultivar_data[cultivar_data$Block == block, ]
block_ag <- block_data %>%
group_by(Pathogen) %>%
summarise(
f3 = sum(T3),
f5 = sum(T5),
f6 = sum(T6),
f7 = sum(T7),
f8 = sum(T8),
f9 = sum(T9),
) %>%
pivot_longer(cols = starts_with("f"), names_to = "TimePoint", values_to = "Freq")
block_ag$Block <- block
combined_data[[block]] <- block_ag
}
long_data <- bind_rows(combined_data)
# Convert TimePoint to a factor for correct ordering
long_data$TimePoint <- factor(long_data$TimePoint, levels = c("f3", "f5", "f6", "f7", "f8", "f9"))
r <- ggplot(long_data, aes(x = TimePoint, y = Freq, group = interaction(Block, Pathogen), color = Pathogen)) +
geom_line() +
facet_wrap(~Block) +
theme_minimal() +
labs(title = "Affected Plant Frequency over Time by Block and Pathogen",
x = "Time Point",
y = "Count of Affected Plants",
color = "Pathogen")
return(r)
}
for (cultivar in unique(new_dataframe$Cultivar)) {
print(analysis_by_cultivar(cultivar))
}
by_cultivar <- split(new_dataframe, new_dataframe$Cultivar)
analysis_by_cultivar <- function(cultivar) {
cultivar_data <- by_cultivar[[cultivar]]
combined_data <- list()
for (block in unique(cultivar_data$Block)) {
block_data <- cultivar_data[cultivar_data$Block == block, ]
block_ag <- block_data %>%
group_by(Pathogen) %>%
summarise(
f3 = sum(T3),
f5 = sum(T5),
f6 = sum(T6),
f7 = sum(T7),
f8 = sum(T8),
f9 = sum(T9),
) %>%
pivot_longer(cols = starts_with("f"), names_to = "TimePoint", values_to = "Freq")
# Add block information
block_ag$Block <- block
combined_data[[block]] <- block_ag
}
long_data <- bind_rows(combined_data)
long_data$TimePoint <- as.numeric(gsub("f", "", long_data$TimePoint))
# Add a regression line
r <- ggplot(long_data, aes(x = TimePoint, y = Freq, group = interaction(Block, Pathogen), color = Pathogen)) +
geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = FALSE) +
facet_wrap(~Block) +
theme_minimal() +
labs(title = paste("Affected Plant Frequency over Time by Block and Pathogen for", cultivar),
x = "Time Point",
y = "Frequency of Affected Plants",
color = "Pathogen")
return(r)
}
for (cultivar in unique(new_dataframe$Cultivar)) {
print(analysis_by_cultivar(cultivar))
}
analysis_by_cultivar <- function(cultivar, with_regression = FALSE) {
cultivar_data <- by_cultivar[[cultivar]]
combined_data <- list()
for (block in unique(cultivar_data$Block)) {
block_data <- cultivar_data[cultivar_data$Block == block, ]
block_ag <- block_data %>%
group_by(Pathogen) %>%
summarise(
f3 = sum(T3),
f5 = sum(T5),
f6 = sum(T6),
f7 = sum(T7),
f8 = sum(T8),
f9 = sum(T9),
) %>%
pivot_longer(cols = starts_with("f"), names_to = "TimePoint", values_to = "Freq")
# Add block information
block_ag$Block <- block
combined_data[[block]] <- block_ag
}
long_data <- bind_rows(combined_data)
long_data$TimePoint <- as.numeric(gsub("f", "", long_data$TimePoint))
# Add a regression line
r <- ggplot(long_data, aes(x = TimePoint, y = Freq, group = interaction(Block, Pathogen), color = Pathogen)) +
facet_wrap(~Block) +
theme_minimal() +
labs(title = paste("Affected Plant Frequency over Time by Block and Pathogen for", cultivar),
x = "Time Point",
y = "Frequency of Affected Plants",
color = "Pathogen")
if (with_regression) {
r <- r + geom_smooth(method = "lm", formula = y ~ poly(x, 2), se = FALSE)
}
return(r)
}
# Without Regression
for (cultivar in unique(new_dataframe$Cultivar)) {
print(analysis_by_cultivar(cultivar, FALSE))
}
# With Quadratic Regression
for (cultivar in unique(new_dataframe$Cultivar)) {
print(analysis_by_cultivar(cultivar, TRUE))
}
# Without Regression
for (cultivar in unique(new_dataframe$Cultivar)) {
print(analysis_by_cultivar(cultivar, FALSE))
}
by_cultivar <- split(new_dataframe, new_dataframe$Cultivar )
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(dplyr)
library(lme4)
library(ordinal)
library(ggplot2)
library(tidyverse)
library(corrplot)
library(caret)
library(ggpubr)
library(e1071)
library(rpart)
experiment_setup <- read.csv("experiment_setup.csv", sep = ";")
disease_score <- read.csv("disease_score.csv", sep = ";")
get_cultivar_label <- function(x) {
experiment_setup[experiment_setup$Cultivar == x,][1,]$Sensitivity
}
disease_score$sensitivity <- unlist(lapply(disease_score$Cultivar, get_cultivar_label))
n <- dim(disease_score)[1]
disease_score <- disease_score[1:(n-3),]
disease_score_clean <- disease_score %>%
filter(!is.na(sensitivity) & sensitivity != "",
T5.affected..0.1. >= 0, T5.Relative.Growth.Rate.RGR..cm. >= 0,
T9.affected..0.1. >= 0, T9.RGR..cm. >= 0)
disease_score_clean <- subset(disease_score, Pathogen != "negative control")
disease_score_clean <- na.omit(disease_score_clean)
disease_score_clean
disease_score_clean$Treatment <- disease_score_clean$Treatment..1.34.
disease_score_clean$Block <- disease_score_clean$Block.nr.
disease_score_clean$Plant_nr <- disease_score_clean$Plant.nr.
disease_score_clean$T3 <- disease_score_clean$T3.disease..0.1.
disease_score_clean$T4 <- disease_score_clean$T4.disease....leaves.
disease_score_clean$T5_per <- disease_score_clean$T5.disease....
disease_score_clean$T5 <- disease_score_clean$T5.affected..0.1.
disease_score_clean$T6_per <- disease_score_clean$T6.disease....
disease_score_clean$T6 <- disease_score_clean$T6.affected..0.1.
disease_score_clean$T7_per <- disease_score_clean$T7.disease....
disease_score_clean$T7 <- disease_score_clean$T7.affected..0.1.
disease_score_clean$T8_per <- disease_score_clean$T8.disease....
disease_score_clean$T8 <- disease_score_clean$T8.affected..0.1.
disease_score_clean$T8_con <- disease_score_clean$T8.mate.disease..0.3.
disease_score_clean$T9_per <- disease_score_clean$T9.disease....
disease_score_clean$T9 <- disease_score_clean$T9.affected..0.1.
disease_score_clean$T9_con <- disease_score_clean$T9.mate.disease..0.3.
disease_score_clean$T5_length <- disease_score_clean$T5.length..cm.
disease_score_clean$T5_RGR <- disease_score_clean$T5.Relative.Growth.Rate.RGR..cm.
disease_score_clean$T9_length <- disease_score_clean$T9.length..cm.
disease_score_clean$T9_RGR <- disease_score_clean$T9.RGR..cm.
disease_score_clean$sensitivity_f <- disease_score_clean$sensitivity
disease_score_clean$time_to_first <- apply(disease_score_clean[,c("T3", "T5", "T6", "T7", "T8","T9")], 1, function(x) {
affected_week <- which(x == 1)
if (length(affected_week) == 0) {
return(70)
} else {
return(affected_week[1])
}
})
new_dataframe <- data.frame()
new_dataframe <- disease_score_clean %>%
select(sensitivity_f, Treatment, Soiltype, Cultivar, Pathogen, Plant_nr, Block, T3, T4, T5, T5_per, T6, T6_per, T7, T7_per, T8, T8_per, T9, T9_per, time_to_first, T5_length, T9_length, T5_RGR, T9_RGR, T8_con, T9_con, )
new_dataframe$sensitivity_f <- factor(new_dataframe$sensitivity_f, ordered = TRUE,
levels = c("Very sensitive", "Sensitive", "Reasonably sensitive",
"intermediate with some damage", "Relatively tolerant", "tolerant",
"highly tolerant", "Resistant"))
new_dataframe$T3 <- ifelse(new_dataframe$T3 == 0, 1, 0)
new_dataframe$T5 <- ifelse(new_dataframe$T5 == 0, 1, 0)
new_dataframe$T6 <- ifelse(new_dataframe$T6 == 0, 1, 0)
new_dataframe$T7 <- ifelse(new_dataframe$T7 == 0, 1, 0)
new_dataframe$T8 <- ifelse(new_dataframe$T8 == 0, 1, 0)
new_dataframe$T9 <- ifelse(new_dataframe$T9 == 0, 1, 0)
new_dataframe$Pathogen <- factor(disease_score_clean$Pathogen)
new_dataframe$Soiltype <- factor(disease_score_clean$Soiltype)
new_dataframe$Cultivar <- factor(disease_score_clean$Cultivar)
new_dataframe$Treatment <- factor(disease_score_clean$Treatment)
new_dataframe$T8_con <- factor(new_dataframe$T8_con, levels = 0:3)
new_dataframe$T9_con <- factor(new_dataframe$T9_con, levels = 0:3)
new_dataframe$T5_length <- as.numeric(sub(",", ".", new_dataframe$T5_length, fixed = TRUE))
new_dataframe$T9_length <- as.numeric(sub(",", ".", new_dataframe$T9_length, fixed = TRUE))
new_dataframe$T5_RGR <- as.numeric(sub(",", ".", new_dataframe$T5_RGR, fixed = TRUE))
new_dataframe$T9_RGR <- as.numeric(sub(",", ".", new_dataframe$T9_RGR, fixed = TRUE))
summary(new_dataframe)
# Bar plot for Sensitivity_f
ggplot(new_dataframe) + aes(x = sensitivity_f) +
geom_bar(fill = "darkmagenta") + coord_flip() +
theme_minimal() +
labs(title = "Bar Plot of Sensitivity", x = "Sensitivity", y = "Count")
# Bar plot for Pathogen
ggplot(new_dataframe, aes(x = Pathogen)) +
geom_bar(fill = "coral") +
theme_minimal() +
labs(title = "Bar Plot of Pathogen", x = "Pathogen", y = "Count")
# Bar plot for Cultivar
ggplot(new_dataframe, aes(x = Cultivar)) +
geom_bar(fill = "blue", width = 0.5) + coord_flip() +
theme_minimal() +
labs(title = "Bar Plot of Cultivar", x = "Cultivar", y = "Count")
# Bar plot for Soil type
ggplot(new_dataframe, aes(x = Soiltype)) +
geom_bar(fill = "green", width = 0.5) +
theme_minimal() +
labs(title = "Bar Plot of Soil type", x = "Soil type", y = "Count")
average_affected_leaves <- aggregate(T4 ~ Cultivar, data = new_dataframe, mean)
average_affected_leaves_sorted <- average_affected_leaves %>%
arrange(desc(T4))
ggplot(average_affected_leaves_sorted, aes(x = reorder(Cultivar, T4), y = T4)) +
geom_bar(stat = "identity", fill = "blue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(x = "Cultivar", y = "Average Affected Leaves", title = "Average Number of Affected Leaves per Cultivar")
by_cultivar <- split(new_dataframe, new_dataframe$Cultivar )
